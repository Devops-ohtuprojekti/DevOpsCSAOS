# Backend API

Backend provides REST API for handling surveys. It is an Express server that uses Sequelize as an ORM to abstract PostgreSQL database. All endpoints return data in json form. Endpoints are listed below.

## API endpoints

| URI                       | METHOD | DATA FORMAT |  DESCRIPTION                                                                                                                                                                                                                                                                                                                                                          | AUTHENTICATION REQUIRED  |
| ------------------------- | ------ | ----------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------ |
| /api/user-groups/validate/:groupid | GET    | json        | Checks if survey user group by given group id exists                                                                                                                                                                                                                                                                                                                  |  No                      |
| /api/questions/:surveyId  | GET    | json        | Searches for questions by survey id                                                                                                                                                                                                                                                                                                                                   |  No                      |
| /api/users                | POST   | json        | Creates a new user                                                                                                                                                                                                                                                                                                                                                    |  No                      |
| /api/answers              | POST   | json        | Saves answers to database and returns summary of results                                                                                                                                                                                                                                                                                                              |  No                      |
| /api/answers/emailsubmit  | POST   | json        | Updates email to user's details. If user has previously submitted answers with same group id and email, previous answers are updated. Creates new survey user group if user has entered the survey without an existing group id and if used has ticket the 'Create a group' box when submitting. Saves industry id to user's details if user has selected an industry |  Yes                     |
| /api/industries           | GET    | json        | Searches for all industries                                                                                                                                                                                                                                                                                                                                           |  No                      |
| /api/results/:token           | GET    | json        | Identifies user by token and searches for user's newest answers to survey by user id. Calculates user's full results by user's newest answers and survey id and returns the results. If user has group and/or industry id, group and/or industry averages by category are calculated and returned.                                                                                                                                                                                                                                                                                                                                         |  Yes                      |
